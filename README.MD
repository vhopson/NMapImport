# NMapImport - Import of NMap Scan Results to Code Dx

This script is designed using Python 2 (will be updated when demand for this script increases).
It is designed to ingest the XML file generated by NMap after a scan.  For example:

```
nmap -T4 -A -v -v -v -n -oX nmap_output.xml -Pn --script auth 3.16.206.1
```

Could be used to generate a file `nmap_output.xml`.  This would then be converted into Code Dx XML
by using this script.  Since the output may have multiple hosts scanned, the associated initialization
file is used to focus the conversion.  Here is an example of the initialization (configuration) file.

```
[3.16.206.1]
allowed_ports=80 445 8080
mandatory_ports=80 445 8080 8081
disallowed_ports=
```

By filtering the NMap results based on the information above (multiple hosts may be defined in different
sections of the config).  Any allowed port may or may not be open.  Mandatory ports must be open, and
disallowed ports must be closed.  

## Script Utilization

Given that the configuration file `config.ini` is in the same directory, a simple command of:

```
python nmapImport.py -c config.ini -i nmap_output.xml -o code_dx.xml
```

The `code_dx.xml` file is now compatible as in input file for a Code Dx analysis input.

## Caveats

This needs more thinking, admittedly.  This script is done as a simple proof of concept.

While the script will consume output from a script driven NMap XML file, it will probably not generate
any output.  This needs more research.